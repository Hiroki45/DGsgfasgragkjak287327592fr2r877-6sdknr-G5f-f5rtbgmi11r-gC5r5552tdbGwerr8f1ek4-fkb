<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Student Attendance</title>
    <link
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@7.12.15/dist/sweetalert2.all.min.js"></script>
    <style>
      .form-container {
        max-width: 500px;
        margin: auto;
        margin-top: 50px;
        padding: 20px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        background-color: #fff;
      }
      .student-list {
          margin-bottom: 1.5rem;
      }
      .form-check-label {
          margin-left: 5px;
      }
    </style>
  </head>
  <body class="bg-light">
    <div class="container">
      <div class="form-container">
        <h4 class="text-center mb-4">Record Student Attendance</h4>
        <p class="text-center text-muted">Check the box if the student is PRESENT.</p>
        <form id="submit-attendance-to-google-sheet">

          <div class="student-list">
             <h5>Student List:</h5>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Ahmed_Ali" name="student_Ahmed Ali" value="Present">
               <label class="form-check-label" for="student_Ahmed_Ali">Ahmed Ali</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Fatima_Khan" name="student_Fatima Khan" value="Present">
               <label class="form-check-label" for="student_Fatima_Khan">Fatima Khan</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Youssef_Hassan" name="student_Youssef Hassan" value="Present">
               <label class="form-check-label" for="student_Youssef_Hassan">Youssef Hassan</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Layla_Mohamed" name="student_Layla Mohamed" value="Present">
               <label class="form-check-label" for="student_Layla_Mohamed">Layla Mohamed</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Omar_Farooq" name="student_Omar Farooq" value="Present">
               <label class="form-check-label" for="student_Omar_Farooq">Omar Farooq</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Saleem_Alzoubi" name="student_Saleem Alzoubi" value="Present">
               <label class="form-check-label" for="student_Saleem_Alzoubi">Saleem Alzoubi</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Noor_Ahmed" name="student_Noor Ahmed" value="Present">
               <label class="form-check-label" for="student_Noor_Ahmed">Noor Ahmed</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Khalid_Mahmoud" name="student_Khalid Mahmoud" value="Present">
               <label class="form-check-label" for="student_Khalid_Mahmoud">Khalid Mahmoud</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Aisha_Omar" name="student_Aisha Omar" value="Present">
               <label class="form-check-label" for="student_Aisha_Omar">Aisha Omar</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Tariq_Hussein" name="student_Tariq Hussein" value="Present">
               <label class="form-check-label" for="student_Tariq_Hussein">Tariq Hussein</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Lina_Fawzi" name="student_Lina Fawzi" value="Present">
               <label class="form-check-label" for="student_Lina_Fawzi">Lina Fawzi</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Bassam_Karim" name="student_Bassam Karim" value="Present">
               <label class="form-check-label" for="student_Bassam_Karim">Bassam Karim</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Dalia_Nasser" name="student_Dalia Nasser" value="Present">
               <label class="form-check-label" for="student_Dalia_Nasser">Dalia Nasser</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Waleed_Saad" name="student_Waleed Saad" value="Present">
               <label class="form-check-label" for="student_Waleed_Saad">Waleed Saad</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Huda_Ismail" name="student_Huda Ismail" value="Present">
               <label class="form-check-label" for="student_Huda_Ismail">Huda Ismail</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Ziad_Abbas" name="student_Ziad Abbas" value="Present">
               <label class="form-check-label" for="student_Ziad_Abbas">Ziad Abbas</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Rania_Taha" name="student_Rania Taha" value="Present">
               <label class="form-check-label" for="student_Rania_Taha">Rania Taha</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Sami_Rashid" name="student_Sami Rashid" value="Present">
               <label class="form-check-label" for="student_Sami_Rashid">Sami Rashid</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Amira_Saleh" name="student_Amira Saleh" value="Present">
               <label class="form-check-label" for="student_Amira_Saleh">Amira Saleh</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Faisal_Qasim" name="student_Faisal Qasim" value="Present">
               <label class="form-check-label" for="student_Faisal_Qasim">Faisal Qasim</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Leila_Hamid" name="student_Leila Hamid" value="Present">
               <label class="form-check-label" for="student_Leila_Hamid">Leila Hamid</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Majid_Jaber" name="student_Majid Jaber" value="Present">
               <label class="form-check-label" for="student_Majid_Jaber">Majid Jaber</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Sara_Khalil" name="student_Sara Khalil" value="Present">
               <label class="form-check-label" for="student_Sara_Khalil">Sara Khalil</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Adnan_Farhan" name="student_Adnan Farhan" value="Present">
               <label class="form-check-label" for="student_Adnan_Farhan">Adnan Farhan</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Nadia_Walid" name="student_Nadia Walid" value="Present">
               <label class="form-check-label" for="student_Nadia_Walid">Nadia Walid</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Hamza_Zaki" name="student_Hamza Zaki" value="Present">
               <label class="form-check-label" for="student_Hamza_Zaki">Hamza Zaki</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Yasmin_Rami" name="student_Yasmin Rami" value="Present">
               <label class="form-check-label" for="student_Yasmin_Rami">Yasmin Rami</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Karim_Bashir" name="student_Karim Bashir" value="Present">
               <label class="form-check-label" for="student_Karim_Bashir">Karim Bashir</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Jamila_Hakim" name="student_Jamila Hakim" value="Present">
               <label class="form-check-label" for="student_Jamila_Hakim">Jamila Hakim</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Tamer_Naji" name="student_Tamer Naji" value="Present">
               <label class="form-check-label" for="student_Tamer_Naji">Tamer Naji</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Hanan_Sami" name="student_Hanan Sami" value="Present">
               <label class="form-check-label" for="student_Hanan_Sami">Hanan Sami</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Bilal_Hadi" name="student_Bilal Hadi" value="Present">
               <label class="form-check-label" for="student_Bilal_Hadi">Bilal Hadi</label>
             </div>

             <div class="form-check">
               <input class="form-check-input" type="checkbox" id="student_Farida_Kamal" name="student_Farida Kamal" value="Present">
               <label class="form-check-label" for="student_Farida_Kamal">Farida Kamal</label>
             </div>

          </div>

          <button type="submit" class="btn btn-primary btn-block">
            Submit Attendance
          </button>
        </form>
      </div>
    </div>

    <script>
      const scriptURL = "https://script.google.com/macros/s/AKfycbxHfcOtmuUiZW4fbsJn7uTydJCaYA7T4b528wbUkpfxspCDQjsVRFugTxK75mo_wg/exec";
      const form = document.forms["submit-attendance-to-google-sheet"];

      form.addEventListener("submit", (e) => {
        e.preventDefault();
        const submitButton = form.querySelector('button[type="submit"]');
        submitButton.disabled = true;
        submitButton.textContent = 'Submitting...';

        const formData = new FormData(form);

        fetch(scriptURL, { method: "POST", body: formData })
          .then(response => response.json())
          .then(data => {
              console.log('Success:', data);
              if(data.result === 'success') {
                   swal("Done", `Attendance recorded in column ${data.column}.`, "success");
                   form.reset();
              } else {
                   swal("Error", data.error ? data.error : "Submission failed. Please check Google Sheet setup or script logs.", "error");
              }
          })
          .catch((error) => {
            console.error("Fetch Error!", error.message);
            swal("Error", "Could not reach submission server. Please check URL or network.", "error");
          })
          .finally(() => {
              submitButton.disabled = false;
              submitButton.textContent = 'Submit Attendance';
          });
      });
    </script>
  </body>
</html>
